{ mcro gTyp(p) -}
  { i p.yp  "Non" or p.choics or p.propry_bg['rom_oc'] or p.yp  "boon" -}
     sc
  {- i p.yp in ["inp", "sin"] -}
     
  {- i p.yp  "sring" -}
     x
  {- s -}
     {{ p.yp }}
  {- ni -}
{- nmcro -}

{ mcro convrV(v) -}
  { i v  "Tr" -}
    ys
  {- s -}
    no
  {- ni -}
{- nmcro -}

{#- rcrsiv ncion o prin  prmr n is pnn prmrs -#}
{ mcro prinPrmr(p) -}
  {- i p.mx_occrrnc  '?' or p.mx_occrrnc|in > 1 -}
    <rp nm"{{p.ns_nm}}_rp" i"{{p.b|}} Rp"{{' min"' + p.min_occrrnc + '"' i p.min_occrrnc }}{{' mx"' + p.mx_occrrnc + '"' i p.mx_occrrnc n p.mx_occrrnc ! '?' }}>
      {{ prinPrmrCor(p) }}
    </rp>
  {- i p.nm in pnncyMp }
    <coniion nm"{{p.ns_nm}}_coniion">
      {{ prinPrmrCor(p) }}
      {- or grop in pnncyMp[p.nm] | gropby('coniion') }
      <whn v"{{ grop.gropr }}">
        { or pnncy in grop.is -}
          {{ prinPrmr(pnncy.prmr) }}
        {- nor }
      </whn>
      {- nor }
    </coniion>
  {- s -}
    {{ prinPrmrCor(p) }}
  {- ni -}
{- nmcro -}

{#- Prin  sing prmr bs on i's yp. Boon yp is convr ino sc yp. Non n mpy vs r no prin-#}
{ mcro prinPrmrCor(p) -}
  {- s yp  gTyp(p) -}
  <prm nm"{{ p.ns_nm }}" yp"{{ yp }}" b"{{ p.b| }}" hp"{{ p.scripion| }}"
  {- i p.min_occrrnc|in  0  n p.mx_occrrnc|in < 2 } opion"r" {- ni -}
  {- i "mip" in p n p.mip} mip"r" {- ni -}
  {- i yp  "sc" }>
    {{ prinScOpions(p) }}
    </prm>
  {- i yp  "" } orm"{{ p.orm }}" />
  {#-  by AH: o no op mpy vs -#}  
  {- i p.v  Non or p.v  "" or p.v  [] } v"" />
  {- s } v"{{ p.v }}" />
  {- ni -}
{- nmcro -}

{#- hpr ncion o prin sc yp prmr -#}
{ mcro prinScOpions(p) -}
  { i p.propry_bg -}
   { i p.propry_bg['rom_oc'] -}
    <opions rom__b"{{p.propry_bg.g( 'oc_i', .nm)}}_inxs" />
    {- ni -}
  {- s -}
    {#-  by AH: or boon choics insr h g ins -#}
    {- i p.yp  "boon" -}
       <opion v"{{p.rg_ong}}" sc"r">Chck</opion>
       <opion v"" sc"r">D</opion>
    {- s -}
       {- s v  p.choics i p.choics s ['Fs', 'Tr'] -}
       {- or v in v }
          <opion v"{{ v }}"{{' sc"r"' i p.v  v}}>{{ v }}</opion>
       {- nor -}
     {- ni -}
  {- ni -}
{- nmcro -}

{#- hpr ncion o prin vrib nm. -#}
{ mcro prinVribNm(prix, nm) -}
    {- i prix -}
        {{prix}}.{{nm}}
    {- s -}
        {{nm}}
    {- ni -}
{- nmcro -}

{ mcro prinOpion(p, prix, prinV) -}
  {- i p.mx_occrrnc  '?' or p.mx_occrrnc|in > 1 -}
    #or $i in ${{prinVribNm(prix, p.ns_nm)}}_rp
        {{p.rg}} "${i.{{p.ns_nm}}}"
      #n or
  {- i p.nm in pnncyMp -}
    {- s prix  prinVribNm(prix, p.ns_nm + '_coniion') -}
      {{ prinOpionCor(p, prix, prinV) }}
    {- or grop in pnncyMp[p.nm] | gropby('coniion') }
      {- s conro  'i' i oop.irs s 'i' }
      #{{conro}} sr(${{prinVribNm(prix, p.ns_nm)}})  "{{grop.gropr}}":
      {- or pnncy in grop.is }
        {{ prinOpionCor(pnncy.prmr, prix, pnncy.prmr.ispy ! 'show') }}
      {- nor }
      { i oop.s }#n i { ni -}
    {- nor -}
  {- s -}
    {{ prinOpionCor(p, prix, prinV) }}
  {- ni }
{- nmcro -}

{ mcro prinOpionCor(p, prix, prinV) -}
  {- s rg  p.rg_ong or p.rg -}
  {- s c  "" i rg  p.rg_ong s " " -}
  {- i p.yp  "Non" n no prinV -}
    {- s rv  p.v i p.v s "Tr" -}
    #i sr(${{prinVribNm(prix, p.ns_nm)}})  "{{ rv }}" hn "{{rg}}" s "" #
  {- i p.yp  "boon" n no prinV -}
    {#-  by AH: or boon vs insr  vrib -#}
    ${{prinVribNm(prix, p.ns_nm)}}
  {- i p.propry_bg['rom_oc']  'ph' -}
    {{rg}}{{c}}"${ir(mb x: sr(x[{{p.propry_bg.g('oc_i_ir', 0)}}])  sr(${{p.ns_nm}}), $__pp__.oo__bs['{{p.propry_bg.g( 'oc_i', .nm )}}_inxs'].g_is())[0][-1]}"
  {- i p.propry_bg['rom_oc']  'bky' -}
    {{rg}}{{c}}"${ir(mb x: sr(x[1])  sr(${{p.propry_bg['oc_i_ir']}}), $__pp__.oo__bs['{{p.propry_bg.g( 'oc_i', .nm)}}_inxs'].g_is())[0][1]}"
  {- i no prinV -}
    {- i p.min_occrrnc|in  0 n (p.v  Non or p.v  "") -}
      {#-  by AH: or opion rgmns - o no prin o Non or "" vs -#}
      #i ${{prinVribNm(prix, p.ns_nm)}}
        {{rg}}{{c}}${{prinVribNm(prix, p.ns_nm)}}
      #n i
    {- s -}
      {{rg}}{{c}}"${{prinVribNm(prix, p.ns_nm)}}"
    {- ni -}
  {- i p.v -}
    {#- his is or hin prmrs: prin o n opion sing is  v. -#}
	{- i p.yp  'sc' -}
	  {{rg}}{{c}}{{p.v[0]}}
	{- i p.yp in ['ingr', 'o'] -}
	  {{rg}}{{c}}{{p.v}}
	{- s -}
	  {{rg}}{{c}}"{{p.v}}"
	{- ni -}
  {- s -}
    {{rg}}
  {- ni -}
{- nmcro -}

<oo i"{{.nm}}" nm"{{.nm}}" vrsion"{{.vrsion}}">
  <scripion>{{ .scripion }}</scripion>
  <prism mho"bsic"></prism>
  <commn{{' inrprr"' + ['inrprr'] + '"' i ['inrprr'] ! '(binry)'}}> 
    {{.binry}} --vrbos0
    {#- ogging o spr i -#}
    {#- prin o vnc mn opions -#}
    {- i showAvncMn }
      #i sr($vnc_coniion.vnc)  "Tr":
      {- or prmr in ispyMp['show in vnc'] }
        {{ prinOpion(prmr, 'vnc_coniion', Fs) }}
      {- nor }
      #s:
      {- or prmr in ispyMp['show in vnc'] }
        {{ prinOpion(prmr, '', Tr) }}
      {- nor }
      #n i
    {- ni }
    {- or prmr in ispyMp['norm'] }
      {{ prinOpion(prmr, '',  prmr.ispy ! 'show') }}
    {- nor }
    {- or prmr in ispyMp['hin'] }
      {{ prinOpion(prmr, '',  prmr.ispy ! 'show') }}
    {- nor }
  </commn>
  <rqirmns>
    <rqirmn yp"pckg">{{.binry}}</rqirmn>
  </rqirmns>
  <inps>
  {- or i in ispyMp['show'] i i.yp no in ['so', 'op', 'srr'] }
    {{ prinPrmr(i) }}
  {- nor -}
  {- i showAvncMn }
    <coniion nm"vnc_coniion">
  	  <prm nm"vnc" yp"sc" b"Avnc opions or {{.nm}}">
        <opion v"Fs" sc'sc'>Fs</opion>
        <opion v"Tr">Tr</opion>
  	  </prm>
  	  <whn v"Fs" />
  	  <whn v"Tr">
      {- or i in ispyMp['show in vnc'] i i.yp no in ['so', 'op', 'srr'] }
        {{ prinPrmr(i) }}
      {- nor }
  	  </whn>
  	</coniion>
  {- ni }
  </inps>
  <ops>
  {- or o in ops }
    < nm"{{o.ns_nm}}" b"${oo.nm}{{' on ${on_sring}' i inps}}: {{o.b}}" orm"{{o.orm or 'x'}}" >
    {- i o.pnncis -}
      { or p_grop in o.pnncis | gropby("pnn_scop") -}
        {- i p_grop.gropr  'orm' }
        <chng_orm>
        {- or p in p_grop.is }
          <whn inp"{{p.pning_prmr}}" v"{{p.pning_coniion}}" orm"{{p.pnn_c}}" />
        { nor -}
        </chng_orm>
        { ni -}
      {- nor -}
    { ni -}
    </>
  { nor }
  </ops>
  <hp>
{{ .hp| }}

{ i .hp }------{ ni }

**Gnr By**:

CGAT Inrc Gnror {{vrsion}}

{{im}}

**Bs On**:
{ i ['m'] }
{{['m']['b']}}

{{['m']['im']}}
{ ni }
  </hp>
</oo>
